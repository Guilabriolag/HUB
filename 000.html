/**
 * üß¨ LAB-LOADER v3.0
 * A primeira impress√£o do Ecossistema Labriolag
 */

class LabLoader extends HTMLElement {
    constructor() {
        super();
        this.attachShadow({ mode: 'open' });
    }

    connectedCallback() {
        this.render();
        // Auto-destrui√ß√£o: Remove o loader quando o evento 'lab-ready' √© disparado
        window.addEventListener('lab-ready', () => this.hide());
        
        // Fallback: Se a engine demorar mais de 5s, ele libera a tela
        setTimeout(() => this.hide(), 5000);
    }

    hide() {
        const container = this.shadowRoot.getElementById('loader-wrapper');
        if (container) {
            container.style.opacity = '0';
            setTimeout(() => {
                container.style.display = 'none';
            }, 800);
        }
    }

    render() {
        this.shadowRoot.innerHTML = `
        <style>
            #loader-wrapper {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: #000;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                z-index: 99999;
                transition: opacity 0.8s ease;
                font-family: 'Poppins', sans-serif;
            }

            .logo-container {
                position: relative;
                width: 120px;
                height: 120px;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            /* C√≠rculo Girat√≥rio */
            .spinner {
                position: absolute;
                width: 100%;
                height: 100%;
                border: 2px solid rgba(0, 119, 182, 0.1);
                border-top: 2px solid #0077B6;
                border-radius: 50%;
                animation: spin 1s linear infinite;
            }

            /* Texto Labriolag Centralizado */
            .brand-text {
                color: #fff;
                font-weight: 700;
                font-style: italic;
                letter-spacing: -1px;
                font-size: 1.2rem;
                z-index: 2;
            }

            .status-text {
                margin-top: 30px;
                color: #444;
                font-size: 9px;
                text-transform: uppercase;
                letter-spacing: 4px;
                animation: pulse 1.5s infinite;
            }

            @keyframes spin {
                to { transform: rotate(360deg); }
            }

            @keyframes pulse {
                0%, 100% { opacity: 0.4; }
                50% { opacity: 1; }
            }
        </style>

        <div id="loader-wrapper">
            <div class="logo-container">
                <div class="spinner"></div>
                <div class="brand-text">LAB</div>
            </div>
            <div class="status-text">Iniciando C√©lula...</div>
        </div>
        `;
    }
}

customElements.define('lab-loader', LabLoader);
