<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Card√°pio Vitorelli Final Corrigido</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />
  
  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js" defer></script>
  <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js" defer></script>
  
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
    
    :root {
      --cor-principal: #ff3c3c; /* Vermelho Vitorelli */
      --cor-fundo-cardapio: rgba(0, 0, 0, 0.7);
      --cor-texto: #fff;
      --cor-botao-adicionar: #38c172;
      --cor-botoes-tamanho: #f0ad4e;
      --clr: var(--cor-principal); 
      --bg: #fff;
      --icon-inactive: #999;
    }

    /* Base e Fundo */
    * { margin: 0; padding: 0; box-sizing: border-box; font-family:"Poppins",sans-serif; }
    body {
      /* Imagem de Fundo */
      background: url('https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgtlAIqbNWtq6dQL3X3N_TgGBe8Eul0udZm-YlzXxTFbkbo3sBrpMm6RJ3Pm76fv5PV7rgEGEYSkA_1l_8bJ6AA-YnRZWrtHW1m1PjLsH_Wpjb-FCto68f_a-bJc-sysKvbkXIkASwWP6N3PffP1QDwRY97RHrYiFj_cD2O1MorFgqpYwojgAZeks2s0O/s2400/20250927_014811.jpg') no-repeat center center fixed;
      background-size: cover;
      color: var(--cor-texto);
      /* Espa√ßo para o menu fixo inferior */
      padding-bottom: 90px; 
    }

    /* Header e Logo (Corrigido para evitar problemas de posicionamento) */
    header { 
      text-align: center; 
      padding: 15px 10px;
      background: rgba(0, 0, 0, 0.8); /* Fundo mais escuro para visibilidade */
      border-bottom: 2px solid var(--cor-principal);
      position: relative; /* Volta para posicionamento normal */
      z-index: 100;
    }
    header img {
      width: 80px;
      border-radius: 50%;
      box-shadow: 0 0 10px var(--cor-principal);
    }
    header h1 {
      color: var(--cor-principal);
      font-size: 1.6em;
      margin-top: 5px;
      text-shadow: 1px 1px 3px #000;
    }
    
    /* Layout Totem (Conte√∫do Principal) */
    .main-content {
      display: flex;
      flex-direction: column;
      gap: 20px;
      padding: 20px;
      max-width: 1400px; 
      margin: 0 auto;
    }

    /* T√≠tulo e Destaques */
    #sabores h2 {
        color: var(--cor-principal);
        text-align: center;
        margin-bottom: 20px;
        font-size: 1.8em;
    }
    .subnav {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-bottom: 25px;
        width: 100%;
        max-width: 400px;
    }
    .subnav button.active {
        background-color: var(--cor-principal);
        color: var(--cor-texto);
        box-shadow: 0 0 10px rgba(255, 60, 60, 0.5);
    }
    
    /* Carrossel Swiper 3D (Garante que os itens tenham um fundo vis√≠vel) */
    .swiper {
        width: 100%;
        height: 450px; 
        padding-top: 50px;
        padding-bottom: 50px;
    }
    .swiper-slide {
      background: var(--cor-fundo-cardapio); /* Fundo semi-transparente */
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); /* Sombra para destacar */
      padding: 20px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      width: 320px; 
      height: 350px;
      border-radius: 15px;
      overflow: hidden;
      text-align: center;
    }
    .swiper-slide h4 {
        color: var(--cor-principal);
        font-size: 1.6em;
    }
    .swiper-slide p {
        color: #ccc;
        flex-grow: 1;
    }

    /* Menu de Navega√ß√£o (Inferior) */
    .navigation {
      width: 100%; 
      height: 80px; 
      background: var(--bg); 
      position: fixed; 
      bottom: 0; 
      left: 0;
      box-shadow: 0 -5px 20px rgba(0,0,0,.3); 
      z-index: 2000;
      display: flex; 
      align-items: center; 
      justify-content: center;
    }
    .navigation ul {
      display: flex; 
      width: 100%; 
      max-width: 600px; 
      justify-content: space-around; 
      align-items: center;
    }
    
    /* Carrinho Modal */
    #carrinho-lateral {
        z-index: 3000; /* Z-index maior que o menu de navega√ß√£o */
    }
    /* Media Query Principal para Responsividade (Desktop) */
    @media (min-width: 900px) {
        .main-content {
            flex-direction: row; 
        }
    }
  </style>
  </head>
<body>

  <header>
    <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgIVywerTEx7Qorio908b4OTVv3x2yo2lPl38CVdhCxtJOK23tK_pRTy8-hcSIWtNLZ6ifuzf8WhXOmFqf_oO_b6L5F89I598_vU5lI13l6X9c2xX4qO01q_Q3_Q1g_v4Jq_W7i5qL4/s300/vitorelli-logo-redonda.png" alt="Logo Pizzaria Vitorelli">
    <h1>Card√°pio Digital</h1>
  </header>
  
  <div class="main-content">
    
    <div id="sabores">
      <h2>Pizzas - Inteira</h2>
      
      <div class="subnav">
        <button id="btn-inteira" class="active" onclick="mostrar('inteira', this)">üçï Pizza Inteira</button>
        <button id="btn-meia" onclick="mostrar('meia', this)">‚úÇÔ∏è Meia-a-meia</button>
      </div>

      <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="carousel-wrapper">
          </div>
      </div>
    </div>
  </div>

  <div id="carrinho-lateral">
    <div id="carrinho-conteudo">
        <button id="fecharCarrinho" style="position: absolute; top: 10px; right: 10px; background: none; border: none; font-size: 1.5em; color: #555; cursor: pointer;" onclick="toggleCarrinho(false)">X</button>
        <h3 style="color:var(--cor-principal); margin-bottom: 15px;">üõí Resumo do Pedido</h3>
        
        <div id="carrinho-detalhes">
            <ul id="carrinho-lista">
                <li id="empty-cart-message">O carrinho est√° vazio.</li>
            </ul>
        </div>
        
        <div id="resumo-valores">
            <p>Subtotal: <span id="subtotal">R$ 0,00</span></p>
            <p id="taxa-entrega-row" style="display:none;">Taxa de Entrega: <span id="taxa-entrega">R$ 0,00</span></p>
            <h4>Total: <span id="total-final">R$ 0,00</span></h4>
        </div>
        
        <div id="opcoes-pedido">
          <label for="entrega" style="display: block; margin-top: 15px; font-weight: bold;">Op√ß√£o de Servi√ßo:</label>
          <select id="entrega" onchange="atualizarOpcoesEntrega()" style="width: 100%; padding: 8px; margin-top: 5px; border-radius: 5px; border: 1px solid #ddd;">
            <option value="Delivery">Delivery (Entrega)</option>
            <option value="Retirar">Retirar no Local</option>
          </select>

          <div id="delivery-options" class="opcoes-grupo" style="margin-top: 10px;">
            <input type="text" id="endereco" placeholder="Seu Endere√ßo e N√∫mero" required style="width: 100%; padding: 8px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ddd;">
            <select id="bairro" onchange="renderizarCarrinho()" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ddd;">
              <option value="">Selecione o Bairro</option>
              <option value="Centro">Centro (R$ 3,00)</option>
              <option value="Vila Nova">Vila Nova (R$ 3,00)</option>
              <option value="JD. Bom Jesus">JD. Bom Jesus (R$ 3,00)</option>
              <option value="Ch√°cara Boa Vista">Ch√°cara Boa Vista (R$ 3,00)</option>
              <option value="Parque das Avencas">Parque das Avencas (R$ 3,00)</option>
              <option value="Morro Branco">Morro Branco (R$ 4,00)</option>
              <option value="Paiol/KM 50">Paiol/KM 70 (R$ 7,00)</option>
              <option value="Green Hills">Green Hills (R$ 10,00)</option>
              <option value="Trailer Club Gaivota">Trailer Club Gaivota (R$ 10,00)</option>
            </select>
          </div>

          <label for="pagamento" style="display: block; margin-top: 15px; font-weight: bold;">Forma de Pagamento:</label>
          <select id="pagamento" onchange="atualizarOpcoesTroco()" style="width: 100%; padding: 8px; margin-top: 5px; border-radius: 5px; border: 1px solid #ddd;">
            <option value="Pix">Pix</option>
            <option value="Cartao">Cart√£o (Cr√©dito/D√©bito)</option>
            <option value="Dinheiro">Dinheiro</option>
          </select>
          
          <div id="troco-options" class="opcoes-grupo" style="display:none; margin-top: 10px;">
            <label for="precisaTroco" style="display: block; font-weight: bold; margin-bottom: 5px;">Precisa de Troco?</label>
            <select id="precisaTroco" onchange="exibirValorTroco()" style="width: 100%; padding: 8px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ddd;">
              <option value="Nao">N√£o</option>
              <option value="Sim">Sim</option>
            </select>
            <input type="number" id="valorTroco" placeholder="Troco para qual valor?" style="display:none; width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ddd;">
          </div>
        </div>
        
        <button onclick="enviarPedido()" class="botao-whatsapp">
          Enviar Pedido (WhatsApp)
        </button>
    </div>
  </div>

  <div id="toast-notification" style="/* estilos do toast */"></div>

  <div id="custom-alert-overlay" style="display:none; /* estilos do overlay */">
    <div id="custom-alert-box" style="/* estilos do alert */">
      <h4 id="custom-alert-title" style="/* estilos do t√≠tulo */"></h4>
      <p id="custom-alert-message" style="/* estilos da mensagem */"></p>
      <button onclick="document.getElementById('custom-alert-overlay').style.display='none'" style="/* estilos do bot√£o */">OK</button>
    </div>
  </div>
  
  <nav class="navigation">
    <ul id="main-nav-list">
      <li class="active" data-categoria="pizza">
        <a href="#" onclick="event.preventDefault(); selecionar('pizza'); activateNav(this);">
          <span class="icon"><ion-icon name="pizza-outline"></ion-icon></span>
          <span class="text">Pizzas</span>
        </a>
      </li>
      <li data-categoria="broto">
        <a href="#" onclick="event.preventDefault(); selecionar('broto'); activateNav(this);">
          <span class="icon"><ion-icon name="ellipse-outline"></ion-icon></span>
          <span class="text">Brotos</span>
        </a>
      </li>
      <li data-categoria="calzone">
        <a href="#" onclick="event.preventDefault(); selecionar('calzone'); activateNav(this);">
          <span class="icon"><ion-icon name="cube-outline"></ion-icon></span>
          <span class="text">Calzone</span>
        </a>
      </li>
      <li data-categoria="bebidas">
        <a href="#" onclick="event.preventDefault(); selecionar('bebidas'); activateNav(this);">
          <span class="icon"><ion-icon name="beer-outline"></ion-icon></span>
          <span class="text">Bebidas</span>
        </a>
      </li>
      <li data-categoria="ingredientes">
        <a href="#" onclick="event.preventDefault(); selecionar('ingredientes'); activateNav(this);">
          <span class="icon"><ion-icon name="leaf-outline"></ion-icon></span>
          <span class="text">Extras</span>
        </a>
      </li>
      <li data-categoria="carrinho">
        <a href="#" onclick="event.preventDefault(); toggleCarrinho(true); activateNav(this);">
          <span class="icon"><ion-icon name="cart-outline"></ion-icon></span>
          <span class="text">Carrinho</span>
        </a>
      </li>
    </ul>
  </nav>

  <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
  <script>
    let categoriaAtual = 'pizza';
    let modoMeia = false;
    let saboresSelecionadosMeia = [];
    let mySwiper = null; 
    let carrinhoItens = []; 

    // DADOS REVISADOS DO CARD√ÅPIO
    const cardapio = {
      pizza: [
        { nome: 'Mu√ßarela', precoInteira: 40.00, precoBroto: 30.00, ingredientes: 'molho de tomate, mu√ßarela e or√©gano' },
        { nome: 'Calabresa', precoInteira: 45.00, precoBroto: 35.00, ingredientes: 'molho de tomate, calabresa, cebola e or√©gano' },
        { nome: 'Portuguesa', precoInteira: 50.00, precoBroto: 40.00, ingredientes: 'molho de tomate, mu√ßarela, presunto, ovos, cebola, piment√£o e or√©gano' },
        { nome: 'Frango Catupiry', precoInteira: 55.00, precoBroto: 45.00, ingredientes: 'molho de tomate, mu√ßarela, frango desfiado, Catupiry original e or√©gano' },
        { nome: 'Marguerita', precoInteira: 48.00, precoBroto: 38.00, ingredientes: 'molho de tomate, mu√ßarela, tomate, manjeric√£o fresco e or√©gano' },
        { nome: 'Peperonni', precoInteira: 60.00, precoBroto: 50.00, ingredientes: 'molho de tomate, mu√ßarela, peperonni e azeitonas' },
      ],
      broto: [
        { nome: 'Romeu e Julieta (Broto)', preco: 25.00, ingredientes: 'mu√ßarela, goiabada e queijo catupiry' },
        { nome: 'Chocolate com Morango (Broto)', preco: 30.00, ingredientes: 'creme de chocolate, morangos frescos e granulado' },
      ],
      calzone: [
        { nome: 'Calzone Frango c/ Catupiry', preco: 45.00, ingredientes: 'frango desfiado, Catupiry, mu√ßarela, azeitonas e or√©gano' },
        { nome: 'Calzone Calabresa', preco: 40.00, ingredientes: 'calabresa mo√≠da, cebola, mu√ßarela e or√©gano' },
      ],
      bebidas: [
        { nome: 'Coca-Cola 2L', preco: 15.00, ingredientes: 'Refrigerante' },
        { nome: 'Cerveja Heineken Long Neck', preco: 10.00, ingredientes: 'Cerveja' },
        { nome: '√Ågua Mineral', preco: 4.00, ingredientes: 'Sem G√°s' },
      ],
      ingredientes: [
        { nome: 'Ingrediente Extra: Bacon', preco: 5.00, ingredientes: 'Adicione bacon extra ao seu pedido.' },
        { nome: 'Borda Recheada: Catupiry', preco: 8.00, ingredientes: 'Borda com recheio de Catupiry original.' },
        { nome: 'Borda Recheada: Chocolate', preco: 10.00, ingredientes: 'Borda recheada com chocolate.' },
      ]
    };

    // ===================================================
    // FUN√á√ïES DE EXIBI√á√ÉO E NAVEGA√á√ÉO
    // ===================================================

    function selecionar(categoria) {
      toggleCarrinho(false); 
      // Rola para o topo do conte√∫do principal
      document.querySelector('.main-content').scrollIntoView({ behavior: 'smooth' });
      
      categoriaAtual = categoria;
      const subnav = document.querySelector('.subnav');
      
      if (categoria === 'pizza') {
        subnav.style.display = 'flex';
        // Garante que o modo "Inteira" seja o padr√£o
        document.getElementById('btn-inteira').classList.add('active');
        document.getElementById('btn-meia').classList.remove('active');
        mostrar('inteira');
      } else {
        subnav.style.display = 'none';
        mostrar('inteira'); // 'inteira' aqui √© s√≥ um placeholder para popular os dados
      }
    }

    function mostrar(tipo, element) {
        modoMeia = categoriaAtual === 'pizza' && tipo === 'meia';
        const carouselWrapper = document.getElementById('carousel-wrapper');
        carouselWrapper.innerHTML = ''; 
        saboresSelecionadosMeia = [];

        if (element) {
            document.querySelectorAll('.subnav button').forEach(btn => btn.classList.remove('active'));
            element.classList.add('active');
        }

        let titleElement = document.getElementById('sabores').querySelector('h2');
        if (categoriaAtual === 'pizza') {
            titleElement.textContent = `Pizzas - ${modoMeia ? 'Meia-a-meia' : 'Inteira'}`;
        } else {
            titleElement.textContent = categoriaAtual.charAt(0).toUpperCase() + categoriaAtual.slice(1);
        }

        const itensDaCategoria = cardapio[categoriaAtual] || [];
        
        itensDaCategoria.forEach(item => {
            let precoExibido = item.preco || 0; 
            let precoInteira = item.precoInteira || item.preco || 0;
            let precoBroto = item.precoBroto || item.preco || 0;
            
            if (categoriaAtual === 'pizza') {
                precoExibido = precoInteira;
            } else if (categoriaAtual === 'broto') {
                precoExibido = precoBroto;
            }

            let buttonText = 'Adicionar';
            if (categoriaAtual === 'pizza' && modoMeia) {
                buttonText = 'Escolher 1/2';
            } else if (categoriaAtual === 'ingredientes') {
                buttonText = 'Adicionar Extra';
            }
            
            const slideHTML = `
                <div class="swiper-slide">
                    <div>
                        <h4>${item.nome}</h4>
                        <p>${item.ingredientes}</p>
                    </div>
                    <div>
                        <span class="preco">R$ ${precoExibido.toFixed(2)}</span>
                        <button onclick="adicionar('${item.nome}', ${precoInteira}, ${precoBroto})">
                            ${buttonText}
                        </button>
                    </div>
                </div>
            `;
            carouselWrapper.innerHTML += slideHTML;
        });

        // REINICIALIZA√á√ÉO DO SWIPER (GARANTIDA)
        if (mySwiper) {
            mySwiper.destroy(true, true);
        }
        
        // Timeout para garantir que o DOM foi renderizado antes de inicializar o Swiper
        setTimeout(() => {
            mySwiper = new Swiper(".mySwiper", {
                effect: "coverflow",
                grabCursor: true,
                centeredSlides: true,
                slidesPerView: "auto",
                coverflowEffect: {
                    rotate: 30,
                    stretch: 0,
                    depth: 100,
                    modifier: 1,
                    slideShadows: true,
                },
                loop: true,
            });
        }, 100); 
    }

    // L√ìGICA DE ADI√á√ÉO AO CARRINHO E MEIA-A-MEIA
    function adicionar(nome, precoInteira, precoBroto) {
      
      if (categoriaAtual === 'pizza' && modoMeia) {
        const precoParaMeia = precoInteira;
        
        if (saboresSelecionadosMeia.length < 2) {
          saboresSelecionadosMeia.push({ nome, preco: precoParaMeia }); 
          showToast(`Sabor ${nome} adicionado! Escolha o segundo sabor.`);
          
          if (saboresSelecionadosMeia.length === 2) {
            const [sabor1, sabor2] = saboresSelecionadosMeia;
            const precoFinal = Math.max(sabor1.preco, sabor2.preco);
            const tipoMeia = 'Pizza Meia-a-meia';
            
            carrinhoItens.push({ 
                nome: `${sabor1.nome} & ${sabor2.nome}`, 
                preco: precoFinal, 
                tipo: tipoMeia, 
                qtde: 1 
            });
            renderizarCarrinho();
            showToast(`Meia ${sabor1.nome} e Meia ${sabor2.nome} adicionadas. Total: R$ ${precoFinal.toFixed(2)}.`);
            saboresSelecionadosMeia = [];
            toggleCarrinho(true); 
          }
        }
      } 
      else {
        let tipoItem = categoriaAtual.charAt(0).toUpperCase() + categoriaAtual.slice(1);
        let preco = precoInteira; 
        
        if (categoriaAtual === 'broto') {
            preco = precoBroto; 
            tipoItem = 'Broto';
        } else if (categoriaAtual !== 'pizza') {
            preco = precoInteira; 
        }

        carrinhoItens.push({ 
            nome: nome, 
            preco: preco, 
            tipo: tipoItem, 
            qtde: 1 
        });
        renderizarCarrinho();
        showToast(`${nome} (${tipoItem}) adicionado(a). R$ ${preco.toFixed(2)}.`);
      }
    }
    
    // As fun√ß√µes renderizarCarrinho, toggleCarrinho, showToast, calcularTaxa, 
    // atualizarOpcoesEntrega, atualizarOpcoesTroco, exibirValorTroco e enviarPedido
    // permanecem as mesmas e est√£o completas no c√≥digo.

    function renderizarCarrinho() {
        const lista = document.getElementById('carrinho-lista');
        const subtotalSpan = document.getElementById('subtotal');
        const totalSpan = document.getElementById('total-final');
        const taxaRow = document.getElementById('taxa-entrega-row');
        const taxaSpan = document.getElementById('taxa-entrega');

        let subtotal = 0;
        let taxaEntrega = 0;
        const entrega = document.getElementById('entrega').value;
        const bairro = document.getElementById('bairro').value;

        lista.innerHTML = '';
        if (carrinhoItens.length === 0) {
            lista.innerHTML = '<li id="empty-cart-message">O carrinho est√° vazio.</li>';
        } else {
            carrinhoItens.forEach((item, index) => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <span style="font-weight: bold;">${item.nome}</span> 
                    <span style="float: right;">R$ ${item.preco.toFixed(2)} 
                        <button onclick="removerItem(${index})" style="background: var(--cor-principal); color: #fff; border: none; padding: 2px 5px; margin-left: 5px; cursor: pointer; border-radius: 3px; font-size: 0.8em; line-height: 1;">X</button>
                    </span>
                    <br><small style="color:#777;">(${item.tipo})</small>
                `;
                lista.appendChild(li);
                subtotal += item.preco;
            });
        }
        
        if (entrega === 'Delivery' && subtotal > 0 && bairro) {
            taxaEntrega = calcularTaxa(bairro);
            taxaRow.style.display = 'flex'; 
        } else {
            taxaEntrega = 0;
            taxaRow.style.display = 'none'; 
        }

        const totalFinal = subtotal + taxaEntrega;
        
        subtotalSpan.textContent = `R$ ${subtotal.toFixed(2)}`;
        taxaSpan.textContent = `R$ ${taxaEntrega.toFixed(2)}`;
        totalSpan.textContent = `R$ ${totalFinal.toFixed(2)}`;
    }

    function removerItem(index) {
        carrinhoItens.splice(index, 1);
        renderizarCarrinho();
        showToast('Item removido do carrinho.');
    }

    function toggleCarrinho(show) {
        const carrinho = document.getElementById('carrinho-lateral');
        
        if (show) {
            renderizarCarrinho();
            carrinho.classList.add('visible'); 
            carrinho.style.display = 'flex'; 
        } else {
            carrinho.classList.remove('visible'); 
            setTimeout(() => carrinho.style.display = 'none', 350); 
        }
    }

    function showToast(message) {
        const toast = document.getElementById('toast-notification');
        toast.textContent = message;
        toast.classList.add('show');
        setTimeout(() => {
            toast.classList.remove('show');
        }, 3000);
    }
    
    function atualizarOpcoesEntrega() {
      const entrega = document.getElementById('entrega').value;
      const deliveryOptions = document.getElementById('delivery-options');
      
      if (entrega === 'Delivery') {
        deliveryOptions.style.display = 'block';
      } else {
        deliveryOptions.style.display = 'none';
      }
      renderizarCarrinho(); 
    }

    function calcularTaxa(bairro) {
        let taxa = 0;
        switch(bairro) {
            case 'Centro': case 'Vila Nova': case 'JD. Bom Jesus': case 'Ch√°cara Boa Vista': case 'Parque das Avencas':
                taxa = 3; break;
            case 'Morro Branco':
                taxa = 4; break;
            case 'Paiol/KM 50':
                taxa = 7; break;
            case 'Green Hills': case 'Trailer Club Gaivota':
                taxa = 10; break;
        }
        return taxa;
    }

    function atualizarOpcoesTroco() {
      const pagamento = document.getElementById('pagamento').value;
      const trocoOptions = document.getElementById('troco-options');
      if (pagamento === 'Dinheiro') {
        trocoOptions.style.display = 'block';
        exibirValorTroco(); 
      } else {
        trocoOptions.style.display = 'none';
      }
    }

    function exibirValorTroco() {
      const precisaTroco = document.getElementById('precisaTroco').value;
      const valorTrocoInput = document.getElementById('valorTroco');
      if (precisaTroco === 'Sim') {
        valorTrocoInput.style.display = 'block';
        valorTrocoInput.required = true;
      } else {
        valorTrocoInput.style.display = 'none';
        valorTrocoInput.required = false;
      }
    }

    function enviarPedido() {
      if (carrinhoItens.length === 0) {
        showCustomAlert('Aten√ß√£o', 'Seu carrinho est√° vazio. Adicione itens antes de enviar o pedido.');
        return;
      }

      const entrega = document.getElementById('entrega').value;
      const pagamento = document.getElementById('pagamento').value;
      
      let msg = `üçï *Pedido Vitorelli - ${new Date().toLocaleDateString('pt-BR')}* üçï\n\n`;
      msg += `üõí *ITENS SELECIONADOS:*\n`;
      
      let subtotal = 0;
      carrinhoItens.forEach(item => {
          msg += `- ${item.nome} (${item.tipo}): R$ ${item.preco.toFixed(2)}\n`;
          subtotal += item.preco;
      });
      
      msg += `\n========================\n`;
      msg += `‚úÖ *SERVI√áO: ${entrega}*\n`;

      let taxa = 0;

      if (entrega === 'Delivery') {
        const endereco = document.getElementById('endereco').value.trim();
        const bairro = document.getElementById('bairro').value;
        
        if (!endereco || !bairro) {
          showCustomAlert('Erro', 'Por favor, preencha o Endere√ßo e selecione o Bairro para Delivery.');
          return;
        }
        
        taxa = calcularTaxa(bairro);
        msg += `\nüìç Endere√ßo: ${endereco}\nüèòÔ∏è Bairro: ${bairro}\nüöö Taxa de entrega: R$ ${taxa.toFixed(2)}\n`;
      } else {
        msg += `\nüßë‚Äçüç≥ Pronto para Retirada no Local.\n`;
      }
      
      const totalFinal = subtotal + taxa;
      
      msg += `\nüí≥ *PAGAMENTO: ${pagamento}*\n`;

      if (pagamento === 'Dinheiro') {
        const precisaTroco = document.getElementById('precisaTroco').value;
        msg += `Troco: ${precisaTroco}`; 
        if (precisaTroco === 'Sim') {
          const valorTroco = document.getElementById('valorTroco').value.trim();
          if (!valorTroco || isNaN(parseFloat(valorTroco))) {
            showCustomAlert('Erro', 'Por favor, informe o valor para o troco em Dinheiro.');
            return;
          }
          msg += ` para R$ ${parseFloat(valorTroco).toFixed(2)}`;
        }
        msg += `\n`;
      }
      
      msg += `\nüí∞ *SUBTOTAL: R$ ${subtotal.toFixed(2)}*\n`;
      if (entrega === 'Delivery') {
          msg += `üöö *TAXA: R$ ${taxa.toFixed(2)}*\n`;
      }
      msg += `üî• *TOTAL GERAL: R$ ${totalFinal.toFixed(2)}*\n`;
      msg += `\n========================\n`;
      msg += `*Agradecemos a prefer√™ncia!*`;

      const numero = '5511993407322'; // N√∫mero de exemplo
      const texto = encodeURIComponent(msg);
      window.open(`https://wa.me/${numero}?text=${texto}`, '_blank');
    }


    function activateNav(element) {
        const list = document.querySelectorAll('.navigation ul li');
        list.forEach(item => item.classList.remove('active'));
        element.parentElement.classList.add('active');
    }

    function showCustomAlert(title, message) {
      document.getElementById('custom-alert-title').innerText = title;
      document.getElementById('custom-alert-message').innerText = message;
      document.getElementById('custom-alert-overlay').style.display = 'flex';
    }

    window.onload = function() {
      atualizarOpcoesEntrega();
      atualizarOpcoesTroco();
      
      // Garante que a categoria "Pizzas" seja a primeira a carregar
      document.querySelector('[data-categoria="pizza"]').classList.add('active');
      selecionar('pizza');
      
      // Listener para o menu inferior (apenas para trocar o estado ativo visualmente)
      const items = document.querySelectorAll('.navigation ul li');
      items.forEach(item => {
        item.addEventListener('click', e => {
          items.forEach(i => i.classList.remove('active'));
          item.classList.add('active');
        });
      });
    };
  </script>
  </body>
</html>
